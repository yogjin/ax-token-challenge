---
import Base from '../layouts/Base.astro';
import { getCollection } from 'astro:content';

const days = (await getCollection('days')).sort((a, b) => b.data.date.localeCompare(a.data.date));
const rawBase = import.meta.env.BASE_URL;
const base = rawBase.endsWith('/') ? rawBase : rawBase + '/';
---

<Base title="Home">
  <div class="hero animate-in">
    <p class="hero-label">AI Literacy Challenge</p>
    <h1>토큰을 의식적으로<br/>쓰고, 공유합니다.</h1>
    <p class="hero-sub">
      <strong>하루 1억 토큰 × 1주.</strong><br/>
      매일 Claude Code로 문제를 해결하고, 그 과정을 기록합니다.
    </p>
  </div>

  <div class="kpi-bar animate-in stagger-2">
    <div class="kpi-item">
      <span class="kpi-number">100M</span>
      <span class="kpi-label">일일 목표 토큰</span>
    </div>
    <div class="kpi-divider"></div>
    <div class="kpi-item">
      <span class="kpi-number">7</span>
      <span class="kpi-label">챌린지 기간 (일)</span>
    </div>
    <div class="kpi-divider"></div>
    <div class="kpi-item">
      <span class="kpi-number">{days.length}</span>
      <span class="kpi-label">작성된 기록</span>
    </div>
  </div>

  <section class="section animate-in stagger-3">
    <h2>왜 하는가</h2>
    <p>
      AI 리터러시를 높이는 가장 빠른 방법은 간단합니다.
      토큰을 많이 쓰는 겁니다. 의식적으로.
    </p>
    <ol>
      <li>Claude $200 플랜을 구독한다.</li>
      <li>Claude Code에서 매일 최소 N 토큰을 쓰려고 의식적으로 노력한다.</li>
      <li>토큰 써서 뭐 했는지, 뭐 만들었는지 공유한다.</li>
      <li>의식하지 않아도 N 토큰을 쓸 수 있게 되면 N을 늘린다.</li>
    </ol>
    <p>
      토큰은 이미 싸고, 앞으로 더 싸질 겁니다.
      중요한 건 <strong>"무엇은 사람이 해야 하고 무엇은 아닌지"</strong>에 대한 감을 익히는 것입니다.
      이 감을 익히는 데 길어야 한 달이고, 개인당 $200이면 충분합니다.
    </p>
  </section>

  <section class="section animate-in stagger-4">
    <div class="section-header">
      <h2>기록</h2>
      <a href={`${base}days/`} class="see-all">전체 보기 &rarr;</a>
    </div>
    {days.length === 0 ? (
      <p class="empty">아직 기록이 없습니다.</p>
    ) : (
      days.map((day, i) => (
        <a href={`${base}days/${day.id}/`} class="card-link">
          <article class={`day-card animate-in stagger-${i + 5}`}>
            <div class="day-card-date">{day.data.date}</div>
            <h3>{day.data.title}</h3>
            <div class="meta">
              토큰: {day.data.tokens} · {day.data.problems}개 문제 해결 · {day.data.tools.join(', ')}
            </div>
          </article>
        </a>
      ))
    )}
  </section>
</Base>

<style>
  .hero {
    padding: 1rem 0 0;
  }

  .hero-label {
    font-size: 0.82rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: var(--accent);
    margin-bottom: 0.8rem;
  }

  .hero h1 {
    font-size: 2.6rem;
    line-height: 1.25;
    margin-bottom: 1rem;
  }

  .hero-sub {
    font-size: 1.05rem;
    color: var(--fg-secondary);
    line-height: 1.7;
    max-width: 480px;
  }

  /* --- KPI Bar --- */
  .kpi-bar {
    display: flex;
    align-items: center;
    gap: 0;
    background: var(--bg-elevated);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 1.3rem 0;
    margin: 2.5rem 0 1rem;
    box-shadow: 0 1px 3px rgba(0,0,0,0.04);
  }

  .kpi-item {
    flex: 1;
    text-align: center;
    display: flex;
    flex-direction: column;
    gap: 0.15rem;
  }

  .kpi-number {
    font-family: var(--font-body);
    font-size: 1.8rem;
    font-weight: 800;
    color: var(--fg);
    line-height: 1;
    letter-spacing: -0.03em;
  }

  .kpi-label {
    font-size: 0.78rem;
    color: var(--muted);
    font-weight: 500;
  }

  .kpi-divider {
    width: 1px;
    height: 36px;
    background: var(--border);
  }

  /* --- Section --- */
  .section {
    margin: 3rem 0 0;
  }

  .section-header {
    display: flex;
    justify-content: space-between;
    align-items: baseline;
  }

  .section-header h2 {
    margin-bottom: 1rem;
  }

  .see-all {
    font-size: 0.85rem;
    font-weight: 500;
    color: var(--muted);
    text-decoration: none;
    transition: color 0.2s;
  }

  .see-all:hover {
    color: var(--accent);
    text-decoration: none;
  }

  /* --- Card Link --- */
  .card-link {
    text-decoration: none;
    color: inherit;
  }

  .card-link:hover {
    text-decoration: none;
  }

  .day-card-date {
    font-size: 0.78rem;
    font-weight: 500;
    color: var(--muted);
    margin-bottom: 0.3rem;
    font-variant-numeric: tabular-nums;
  }

  .empty {
    color: var(--muted);
    font-style: italic;
  }

  @media (max-width: 600px) {
    .hero h1 {
      font-size: 2rem;
    }

    .kpi-bar {
      flex-direction: column;
      gap: 1rem;
      padding: 1.2rem;
    }

    .kpi-divider {
      width: 40px;
      height: 1px;
    }
  }
</style>
